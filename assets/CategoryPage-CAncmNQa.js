import{r as c,R as W,j as i,I as P,L as Mn,f as lt,u as In,a as An,c as zt,b as Tn}from"./index-Cbj6J2n5.js";import{r as Le}from"./index-BwDsoYh0.js";import{g as On}from"./exerciseMapping-Bt-AejFV.js";function Ln(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const tt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Re(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function vt(e){return"nodeType"in e}function H(e){var t,n;return e?Re(e)?e:vt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function mt(e){const{Document:t}=H(e);return e instanceof t}function Xe(e){return Re(e)?!1:e instanceof H(e).HTMLElement}function Zt(e){return e instanceof H(e).SVGElement}function Ee(e){return e?Re(e)?e.document:vt(e)?mt(e)?e:Xe(e)||Zt(e)?e.ownerDocument:document:document:document}const ae=tt?c.useLayoutEffect:c.useEffect;function wt(e){const t=c.useRef(e);return ae(()=>{t.current=e}),c.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function zn(){const e=c.useRef(null),t=c.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=c.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ue(e,t){t===void 0&&(t=[e]);const n=c.useRef(e);return ae(()=>{n.current!==e&&(n.current=e)},t),n}function Ye(e,t){const n=c.useRef();return c.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Qe(e){const t=wt(e),n=c.useRef(null),r=c.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,r]}function ht(e){const t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}let ct={};function He(e,t){return c.useMemo(()=>{if(t)return t;const n=ct[e]==null?0:ct[e]+1;return ct[e]=n,e+"-"+n},[e,t])}function en(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,a)=>{const l=Object.entries(a);for(const[u,d]of l){const f=s[u];f!=null&&(s[u]=f+e*d)}return s},{...t})}}const je=en(1),$e=en(-1);function Pn(e){return"clientX"in e&&"clientY"in e}function yt(e){if(!e)return!1;const{KeyboardEvent:t}=H(e.target);return t&&e instanceof t}function Fn(e){if(!e)return!1;const{TouchEvent:t}=H(e.target);return t&&e instanceof t}function gt(e){if(Fn(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Pn(e)?{x:e.clientX,y:e.clientY}:null}const Be=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Be.Translate.toString(e),Be.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Pt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Un(e){return e.matches(Pt)?e:e.querySelector(Pt)}const $n={display:"none"};function Bn(e){let{id:t,value:n}=e;return W.createElement("div",{id:t,style:$n},n)}function Wn(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return W.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function Xn(){const[e,t]=c.useState("");return{announce:c.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const tn=c.createContext(null);function Yn(e){const t=c.useContext(tn);c.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Hn(){const[e]=c.useState(()=>new Set),t=c.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[c.useCallback(r=>{let{type:o,event:s}=r;e.forEach(a=>{var l;return(l=a[o])==null?void 0:l.call(a,s)})},[e]),t]}const Kn={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},qn={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Vn(e){let{announcements:t=qn,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=Kn}=e;const{announce:s,announcement:a}=Xn(),l=He("DndLiveRegion"),[u,d]=c.useState(!1);if(c.useEffect(()=>{d(!0)},[]),Yn(c.useMemo(()=>({onDragStart(h){let{active:g}=h;s(t.onDragStart({active:g}))},onDragMove(h){let{active:g,over:p}=h;t.onDragMove&&s(t.onDragMove({active:g,over:p}))},onDragOver(h){let{active:g,over:p}=h;s(t.onDragOver({active:g,over:p}))},onDragEnd(h){let{active:g,over:p}=h;s(t.onDragEnd({active:g,over:p}))},onDragCancel(h){let{active:g,over:p}=h;s(t.onDragCancel({active:g,over:p}))}}),[s,t])),!u)return null;const f=W.createElement(W.Fragment,null,W.createElement(Bn,{id:r,value:o.draggable}),W.createElement(Wn,{id:l,announcement:a}));return n?Le.createPortal(f,n):f}var L;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(L||(L={}));function _e(){}function Ft(e,t){return c.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Gn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ne=Object.freeze({x:0,y:0});function nn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function rn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Jn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Ut(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function sn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function $t(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Qn=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=$t(t,t.left,t.top),s=[];for(const a of r){const{id:l}=a,u=n.get(l);if(u){const d=nn($t(u),o);s.push({id:l,data:{droppableContainer:a,value:d}})}}return s.sort(rn)},_n=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Ut(t),s=[];for(const a of r){const{id:l}=a,u=n.get(l);if(u){const d=Ut(u),f=o.reduce((g,p,b)=>g+nn(d[b],p),0),h=Number((f/4).toFixed(4));s.push({id:l,data:{droppableContainer:a,value:h}})}}return s.sort(rn)};function Zn(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),a=o-r,l=s-n;if(r<o&&n<s){const u=t.width*t.height,d=e.width*e.height,f=a*l,h=f/(u+d-f);return Number(h.toFixed(4))}return 0}const er=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:a}=s,l=n.get(a);if(l){const u=Zn(l,t);u>0&&o.push({id:a,data:{droppableContainer:s,value:u}})}}return o.sort(Jn)};function tr(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function on(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ne}function nr(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...n})}}const rr=nr(1);function sr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function or(e,t,n){const r=sr(t);if(!r)return e;const{scaleX:o,scaleY:s,x:a,y:l}=r,u=e.left-a-(1-o)*parseFloat(n),d=e.top-l-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),f=o?e.width/o:e.width,h=s?e.height/s:e.height;return{width:f,height:h,top:d,right:u+f,bottom:d+h,left:u}}const ir={ignoreTransform:!1};function ke(e,t){t===void 0&&(t=ir);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:f}=H(e).getComputedStyle(e);d&&(n=or(n,d,f))}const{top:r,left:o,width:s,height:a,bottom:l,right:u}=n;return{top:r,left:o,width:s,height:a,bottom:l,right:u}}function Bt(e){return ke(e,{ignoreTransform:!0})}function ar(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function lr(e,t){return t===void 0&&(t=H(e).getComputedStyle(e)),t.position==="fixed"}function cr(e,t){t===void 0&&(t=H(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function nt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(mt(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Xe(o)||Zt(o)||n.includes(o))return n;const s=H(e).getComputedStyle(o);return o!==e&&cr(o,s)&&n.push(o),lr(o,s)?n:r(o.parentNode)}return e?r(e):n}function an(e){const[t]=nt(e,1);return t??null}function dt(e){return!tt||!e?null:Re(e)?e:vt(e)?mt(e)||e===Ee(e).scrollingElement?window:Xe(e)?e:null:null}function ln(e){return Re(e)?e.scrollX:e.scrollLeft}function cn(e){return Re(e)?e.scrollY:e.scrollTop}function pt(e){return{x:ln(e),y:cn(e)}}var z;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(z||(z={}));function dn(e){return!tt||!e?!1:e===document.scrollingElement}function un(e){const t={x:0,y:0},n=dn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:a,isRight:l,maxScroll:r,minScroll:t}}const dr={x:.2,y:.2};function ur(e,t,n,r,o){let{top:s,left:a,right:l,bottom:u}=n;r===void 0&&(r=10),o===void 0&&(o=dr);const{isTop:d,isBottom:f,isLeft:h,isRight:g}=un(e),p={x:0,y:0},b={x:0,y:0},x={height:t.height*o.y,width:t.width*o.x};return!d&&s<=t.top+x.height?(p.y=z.Backward,b.y=r*Math.abs((t.top+x.height-s)/x.height)):!f&&u>=t.bottom-x.height&&(p.y=z.Forward,b.y=r*Math.abs((t.bottom-x.height-u)/x.height)),!g&&l>=t.right-x.width?(p.x=z.Forward,b.x=r*Math.abs((t.right-x.width-l)/x.width)):!h&&a<=t.left+x.width&&(p.x=z.Backward,b.x=r*Math.abs((t.left+x.width-a)/x.width)),{direction:p,speed:b}}function fr(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:a}=window;return{top:0,left:0,right:s,bottom:a,width:s,height:a}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function fn(e){return e.reduce((t,n)=>je(t,pt(n)),ne)}function hr(e){return e.reduce((t,n)=>t+ln(n),0)}function gr(e){return e.reduce((t,n)=>t+cn(n),0)}function pr(e,t){if(t===void 0&&(t=ke),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);an(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const xr=[["x",["left","right"],hr],["y",["top","bottom"],gr]];class Nt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=nt(n),o=fn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,a,l]of xr)for(const u of a)Object.defineProperty(this,u,{get:()=>{const d=l(r),f=o[s]-d;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ze{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function br(e){const{EventTarget:t}=H(e);return e instanceof t?e:Ee(e)}function ut(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var ee;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ee||(ee={}));function Wt(e){e.preventDefault()}function vr(e){e.stopPropagation()}var E;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(E||(E={}));const hn={start:[E.Space,E.Enter],cancel:[E.Esc],end:[E.Space,E.Enter,E.Tab]},mr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case E.Right:return{...n,x:n.x+25};case E.Left:return{...n,x:n.x-25};case E.Down:return{...n,y:n.y+25};case E.Up:return{...n,y:n.y-25}}};class Ct{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new ze(Ee(n)),this.windowListeners=new ze(H(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ee.Resize,this.handleCancel),this.windowListeners.add(ee.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ee.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&pr(r),n(ne)}handleKeyDown(t){if(yt(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=hn,coordinateGetter:a=mr,scrollBehavior:l="smooth"}=o,{code:u}=t;if(s.end.includes(u)){this.handleEnd(t);return}if(s.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:d}=r.current,f=d?{x:d.left,y:d.top}:ne;this.referenceCoordinates||(this.referenceCoordinates=f);const h=a(t,{active:n,context:r.current,currentCoordinates:f});if(h){const g=$e(h,f),p={x:0,y:0},{scrollableAncestors:b}=r.current;for(const x of b){const v=t.code,{isTop:D,isRight:S,isLeft:w,isBottom:j,maxScroll:R,minScroll:N}=un(x),m=fr(x),C={x:Math.min(v===E.Right?m.right-m.width/2:m.right,Math.max(v===E.Right?m.left:m.left+m.width/2,h.x)),y:Math.min(v===E.Down?m.bottom-m.height/2:m.bottom,Math.max(v===E.Down?m.top:m.top+m.height/2,h.y))},M=v===E.Right&&!S||v===E.Left&&!w,T=v===E.Down&&!j||v===E.Up&&!D;if(M&&C.x!==h.x){const I=x.scrollLeft+g.x,K=v===E.Right&&I<=R.x||v===E.Left&&I>=N.x;if(K&&!g.y){x.scrollTo({left:I,behavior:l});return}K?p.x=x.scrollLeft-I:p.x=v===E.Right?x.scrollLeft-R.x:x.scrollLeft-N.x,p.x&&x.scrollBy({left:-p.x,behavior:l});break}else if(T&&C.y!==h.y){const I=x.scrollTop+g.y,K=v===E.Down&&I<=R.y||v===E.Up&&I>=N.y;if(K&&!g.x){x.scrollTo({top:I,behavior:l});return}K?p.y=x.scrollTop-I:p.y=v===E.Down?x.scrollTop-R.y:x.scrollTop-N.y,p.y&&x.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,je($e(h,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ct.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=hn,onActivation:o}=t,{active:s}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function Xt(e){return!!(e&&"distance"in e)}function Yt(e){return!!(e&&"delay"in e)}class Dt{constructor(t,n,r){var o;r===void 0&&(r=br(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:a}=s;this.props=t,this.events=n,this.document=Ee(a),this.documentListeners=new ze(this.document),this.listeners=new ze(r),this.windowListeners=new ze(H(a)),this.initialCoordinates=(o=gt(s))!=null?o:ne,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ee.Resize,this.handleCancel),this.windowListeners.add(ee.DragStart,Wt),this.windowListeners.add(ee.VisibilityChange,this.handleCancel),this.windowListeners.add(ee.ContextMenu,Wt),this.documentListeners.add(ee.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Yt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Xt(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ee.Click,vr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ee.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:a,options:{activationConstraint:l}}=s;if(!o)return;const u=(n=gt(t))!=null?n:ne,d=$e(o,u);if(!r&&l){if(Xt(l)){if(l.tolerance!=null&&ut(d,l.tolerance))return this.handleCancel();if(ut(d,l.distance))return this.handleStart()}if(Yt(l)&&ut(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),a(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===E.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const wr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class St extends Dt{constructor(t){const{event:n}=t,r=Ee(n.target);super(t,wr,r)}}St.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const yr={move:{name:"mousemove"},end:{name:"mouseup"}};var xt;(function(e){e[e.RightClick=2]="RightClick"})(xt||(xt={}));class Nr extends Dt{constructor(t){super(t,yr,Ee(t.event.target))}}Nr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===xt.RightClick?!1:(r?.({event:n}),!0)}}];const ft={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Cr extends Dt{constructor(t){super(t,ft)}static setup(){return window.addEventListener(ft.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(ft.move.name,t)};function t(){}}}Cr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r?.({event:n}),!0)}}];var Pe;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Pe||(Pe={}));var Ze;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ze||(Ze={}));function Dr(e){let{acceleration:t,activator:n=Pe.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:a=5,order:l=Ze.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:f,delta:h,threshold:g}=e;const p=jr({delta:h,disabled:!s}),[b,x]=zn(),v=c.useRef({x:0,y:0}),D=c.useRef({x:0,y:0}),S=c.useMemo(()=>{switch(n){case Pe.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Pe.DraggableRect:return o}},[n,o,u]),w=c.useRef(null),j=c.useCallback(()=>{const N=w.current;if(!N)return;const m=v.current.x*D.current.x,C=v.current.y*D.current.y;N.scrollBy(m,C)},[]),R=c.useMemo(()=>l===Ze.TreeOrder?[...d].reverse():d,[l,d]);c.useEffect(()=>{if(!s||!d.length||!S){x();return}for(const N of R){if(r?.(N)===!1)continue;const m=d.indexOf(N),C=f[m];if(!C)continue;const{direction:M,speed:T}=ur(N,C,S,t,g);for(const I of["x","y"])p[I][M[I]]||(T[I]=0,M[I]=0);if(T.x>0||T.y>0){x(),w.current=N,b(j,a),v.current=T,D.current=M;return}}v.current={x:0,y:0},D.current={x:0,y:0},x()},[t,j,r,x,s,a,JSON.stringify(S),JSON.stringify(p),b,d,R,f,JSON.stringify(g)])}const Sr={x:{[z.Backward]:!1,[z.Forward]:!1},y:{[z.Backward]:!1,[z.Forward]:!1}};function jr(e){let{delta:t,disabled:n}=e;const r=ht(t);return Ye(o=>{if(n||!r||!o)return Sr;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[z.Backward]:o.x[z.Backward]||s.x===-1,[z.Forward]:o.x[z.Forward]||s.x===1},y:{[z.Backward]:o.y[z.Backward]||s.y===-1,[z.Forward]:o.y[z.Forward]||s.y===1}}},[n,t,r])}function Rr(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ye(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function Er(e,t){return c.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...s]},[]),[e,t])}var We;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(We||(We={}));var bt;(function(e){e.Optimized="optimized"})(bt||(bt={}));const Ht=new Map;function kr(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,a]=c.useState(null),{frequency:l,measure:u,strategy:d}=o,f=c.useRef(e),h=v(),g=Ue(h),p=c.useCallback(function(D){D===void 0&&(D=[]),!g.current&&a(S=>S===null?D:S.concat(D.filter(w=>!S.includes(w))))},[g]),b=c.useRef(null),x=Ye(D=>{if(h&&!n)return Ht;if(!D||D===Ht||f.current!==e||s!=null){const S=new Map;for(let w of e){if(!w)continue;if(s&&s.length>0&&!s.includes(w.id)&&w.rect.current){S.set(w.id,w.rect.current);continue}const j=w.node.current,R=j?new Nt(u(j),j):null;w.rect.current=R,R&&S.set(w.id,R)}return S}return D},[e,s,n,h,u]);return c.useEffect(()=>{f.current=e},[e]),c.useEffect(()=>{h||p()},[n,h]),c.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),c.useEffect(()=>{h||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{p(),b.current=null},l))},[l,h,p,...r]),{droppableRects:x,measureDroppableContainers:p,measuringScheduled:s!=null};function v(){switch(d){case We.Always:return!1;case We.BeforeDragging:return n;default:return!n}}}function gn(e,t){return Ye(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Mr(e,t){return gn(e,t)}function Ir(e){let{callback:t,disabled:n}=e;const r=wt(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return c.useEffect(()=>()=>o?.disconnect(),[o]),o}function rt(e){let{callback:t,disabled:n}=e;const r=wt(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return c.useEffect(()=>()=>o?.disconnect(),[o]),o}function Ar(e){return new Nt(ke(e),e)}function Kt(e,t,n){t===void 0&&(t=Ar);const[r,o]=c.useState(null);function s(){o(u=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=u??n)!=null?d:null}const f=t(e);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const a=Ir({callback(u){if(e)for(const d of u){const{type:f,target:h}=d;if(f==="childList"&&h instanceof HTMLElement&&h.contains(e)){s();break}}}}),l=rt({callback:s});return ae(()=>{s(),e?(l?.observe(e),a?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),a?.disconnect())},[e]),r}function Tr(e){const t=gn(e);return on(e,t)}const qt=[];function Or(e){const t=c.useRef(e),n=Ye(r=>e?r&&r!==qt&&e&&t.current&&e.parentNode===t.current.parentNode?r:nt(e):qt,[e]);return c.useEffect(()=>{t.current=e},[e]),n}function Lr(e){const[t,n]=c.useState(null),r=c.useRef(e),o=c.useCallback(s=>{const a=dt(s.target);a&&n(l=>l?(l.set(a,pt(a)),new Map(l)):null)},[]);return c.useEffect(()=>{const s=r.current;if(e!==s){a(s);const l=e.map(u=>{const d=dt(u);return d?(d.addEventListener("scroll",o,{passive:!0}),[d,pt(d)]):null}).filter(u=>u!=null);n(l.length?new Map(l):null),r.current=e}return()=>{a(e),a(s)};function a(l){l.forEach(u=>{const d=dt(u);d?.removeEventListener("scroll",o)})}},[o,e]),c.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,a)=>je(s,a),ne):fn(e):ne,[e,t])}function Vt(e,t){t===void 0&&(t=[]);const n=c.useRef(null);return c.useEffect(()=>{n.current=null},t),c.useEffect(()=>{const r=e!==ne;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?$e(e,n.current):ne}function zr(e){c.useEffect(()=>{if(!tt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function Pr(e,t){return c.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=a=>{s(a,t)},n},{}),[e,t])}function pn(e){return c.useMemo(()=>e?ar(e):null,[e])}const Gt=[];function Fr(e,t){t===void 0&&(t=ke);const[n]=e,r=pn(n?H(n):null),[o,s]=c.useState(Gt);function a(){s(()=>e.length?e.map(u=>dn(u)?r:new Nt(t(u),u)):Gt)}const l=rt({callback:a});return ae(()=>{l?.disconnect(),a(),e.forEach(u=>l?.observe(u))},[e]),o}function Ur(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Xe(t)?t:e}function $r(e){let{measure:t}=e;const[n,r]=c.useState(null),o=c.useCallback(d=>{for(const{target:f}of d)if(Xe(f)){r(h=>{const g=t(f);return h?{...h,width:g.width,height:g.height}:g});break}},[t]),s=rt({callback:o}),a=c.useCallback(d=>{const f=Ur(d);s?.disconnect(),f&&s?.observe(f),r(f?t(f):null)},[t,s]),[l,u]=Qe(a);return c.useMemo(()=>({nodeRef:l,rect:n,setRef:u}),[n,l,u])}const Br=[{sensor:St,options:{}},{sensor:Ct,options:{}}],Wr={current:{}},Je={draggable:{measure:Bt},droppable:{measure:Bt,strategy:We.WhileDragging,frequency:bt.Optimized},dragOverlay:{measure:ke}};class Fe extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Xr={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Fe,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:_e},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Je,measureDroppableContainers:_e,windowRect:null,measuringScheduled:!1},Yr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:_e,draggableNodes:new Map,over:null,measureDroppableContainers:_e},st=c.createContext(Yr),xn=c.createContext(Xr);function Hr(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Fe}}}function Kr(e,t){switch(t.type){case L.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case L.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case L.DragEnd:case L.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case L.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Fe(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case L.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new Fe(e.droppable.containers);return a.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:a}}}case L.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new Fe(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function qr(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=c.useContext(st),s=ht(r),a=ht(n?.id);return c.useEffect(()=>{if(!t&&!r&&s&&a!=null){if(!yt(s)||document.activeElement===s.target)return;const l=o.get(a);if(!l)return;const{activatorNode:u,node:d}=l;if(!u.current&&!d.current)return;requestAnimationFrame(()=>{for(const f of[u.current,d.current]){if(!f)continue;const h=Un(f);if(h){h.focus();break}}})}},[r,t,o,a,s]),null}function Vr(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function Gr(e){return c.useMemo(()=>({draggable:{...Je.draggable,...e?.draggable},droppable:{...Je.droppable,...e?.droppable},dragOverlay:{...Je.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Jr(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=c.useRef(!1),{x:a,y:l}=typeof o=="boolean"?{x:o,y:o}:o;ae(()=>{if(!a&&!l||!t){s.current=!1;return}if(s.current||!r)return;const d=t?.node.current;if(!d||d.isConnected===!1)return;const f=n(d),h=on(f,r);if(a||(h.x=0),l||(h.y=0),s.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const g=an(d);g&&g.scrollBy({top:h.y,left:h.x})}},[t,a,l,r,n])}const bn=c.createContext({...ne,scaleX:1,scaleY:1});var ve;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ve||(ve={}));const Qr=c.memo(function(t){var n,r,o,s;let{id:a,accessibility:l,autoScroll:u=!0,children:d,sensors:f=Br,collisionDetection:h=er,measuring:g,modifiers:p,...b}=t;const x=c.useReducer(Kr,void 0,Hr),[v,D]=x,[S,w]=Hn(),[j,R]=c.useState(ve.Uninitialized),N=j===ve.Initialized,{draggable:{active:m,nodes:C,translate:M},droppable:{containers:T}}=v,I=m!=null?C.get(m):null,K=c.useRef({initial:null,translated:null}),X=c.useMemo(()=>{var B;return m!=null?{id:m,data:(B=I?.data)!=null?B:Wr,rect:K}:null},[m,I]),J=c.useRef(null),[le,me]=c.useState(null),[U,re]=c.useState(null),Q=Ue(b,Object.values(b)),y=He("DndDescribedBy",a),O=c.useMemo(()=>T.getEnabled(),[T]),A=Gr(g),{droppableRects:$,measureDroppableContainers:_,measuringScheduled:te}=kr(O,{dragging:N,dependencies:[M.x,M.y],config:A.droppable}),Y=Rr(C,m),Ke=c.useMemo(()=>U?gt(U):null,[U]),fe=kn(),ce=Mr(Y,A.draggable.measure);Jr({activeNode:m!=null?C.get(m):null,config:fe.layoutShiftCompensation,initialRect:ce,measure:A.draggable.measure});const k=Kt(Y,A.draggable.measure,ce),Me=Kt(Y?Y.parentElement:null),se=c.useRef({activatorEvent:null,active:null,activeNode:Y,collisionRect:null,collisions:null,droppableRects:$,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:T,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),we=T.getNodeFor((n=se.current.over)==null?void 0:n.id),de=$r({measure:A.dragOverlay.measure}),ye=(r=de.nodeRef.current)!=null?r:Y,Ne=N?(o=de.rect)!=null?o:k:null,Et=!!(de.nodeRef.current&&de.rect),kt=Tr(Et?null:k),ot=pn(ye?H(ye):null),he=Or(N?we??Y:null),qe=Fr(he),Ve=Vr(p,{transform:{x:M.x-kt.x,y:M.y-kt.y,scaleX:1,scaleY:1},activatorEvent:U,active:X,activeNodeRect:k,containerNodeRect:Me,draggingNodeRect:Ne,over:se.current.over,overlayNodeRect:de.rect,scrollableAncestors:he,scrollableAncestorRects:qe,windowRect:ot}),Mt=Ke?je(Ke,M):null,It=Lr(he),Nn=Vt(It),Cn=Vt(It,[k]),Ce=je(Ve,Nn),De=Ne?rr(Ne,Ve):null,Ie=X&&De?h({active:X,collisionRect:De,droppableRects:$,droppableContainers:O,pointerCoordinates:Mt}):null,At=sn(Ie,"id"),[ge,Tt]=c.useState(null),Dn=Et?Ve:je(Ve,Cn),Sn=tr(Dn,(s=ge?.rect)!=null?s:null,k),it=c.useRef(null),Ot=c.useCallback((B,q)=>{let{sensor:V,options:pe}=q;if(J.current==null)return;const Z=C.get(J.current);if(!Z)return;const G=B.nativeEvent,oe=new V({active:J.current,activeNode:Z,event:G,options:pe,context:se,onAbort(F){if(!C.get(F))return;const{onDragAbort:ie}=Q.current,ue={id:F};ie?.(ue),S({type:"onDragAbort",event:ue})},onPending(F,xe,ie,ue){if(!C.get(F))return;const{onDragPending:Te}=Q.current,be={id:F,constraint:xe,initialCoordinates:ie,offset:ue};Te?.(be),S({type:"onDragPending",event:be})},onStart(F){const xe=J.current;if(xe==null)return;const ie=C.get(xe);if(!ie)return;const{onDragStart:ue}=Q.current,Ae={activatorEvent:G,active:{id:xe,data:ie.data,rect:K}};Le.unstable_batchedUpdates(()=>{ue?.(Ae),R(ve.Initializing),D({type:L.DragStart,initialCoordinates:F,active:xe}),S({type:"onDragStart",event:Ae}),me(it.current),re(G)})},onMove(F){D({type:L.DragMove,coordinates:F})},onEnd:Se(L.DragEnd),onCancel:Se(L.DragCancel)});it.current=oe;function Se(F){return async function(){const{active:ie,collisions:ue,over:Ae,scrollAdjustedTranslate:Te}=se.current;let be=null;if(ie&&Te){const{cancelDrop:Oe}=Q.current;be={activatorEvent:G,active:ie,collisions:ue,delta:Te,over:Ae},F===L.DragEnd&&typeof Oe=="function"&&await Promise.resolve(Oe(be))&&(F=L.DragCancel)}J.current=null,Le.unstable_batchedUpdates(()=>{D({type:F}),R(ve.Uninitialized),Tt(null),me(null),re(null),it.current=null;const Oe=F===L.DragEnd?"onDragEnd":"onDragCancel";if(be){const at=Q.current[Oe];at?.(be),S({type:Oe,event:be})}})}}},[C]),jn=c.useCallback((B,q)=>(V,pe)=>{const Z=V.nativeEvent,G=C.get(pe);if(J.current!==null||!G||Z.dndKit||Z.defaultPrevented)return;const oe={active:G};B(V,q.options,oe)===!0&&(Z.dndKit={capturedBy:q.sensor},J.current=pe,Ot(V,q))},[C,Ot]),Lt=Er(f,jn);zr(f),ae(()=>{k&&j===ve.Initializing&&R(ve.Initialized)},[k,j]),c.useEffect(()=>{const{onDragMove:B}=Q.current,{active:q,activatorEvent:V,collisions:pe,over:Z}=se.current;if(!q||!V)return;const G={active:q,activatorEvent:V,collisions:pe,delta:{x:Ce.x,y:Ce.y},over:Z};Le.unstable_batchedUpdates(()=>{B?.(G),S({type:"onDragMove",event:G})})},[Ce.x,Ce.y]),c.useEffect(()=>{const{active:B,activatorEvent:q,collisions:V,droppableContainers:pe,scrollAdjustedTranslate:Z}=se.current;if(!B||J.current==null||!q||!Z)return;const{onDragOver:G}=Q.current,oe=pe.get(At),Se=oe&&oe.rect.current?{id:oe.id,rect:oe.rect.current,data:oe.data,disabled:oe.disabled}:null,F={active:B,activatorEvent:q,collisions:V,delta:{x:Z.x,y:Z.y},over:Se};Le.unstable_batchedUpdates(()=>{Tt(Se),G?.(F),S({type:"onDragOver",event:F})})},[At]),ae(()=>{se.current={activatorEvent:U,active:X,activeNode:Y,collisionRect:De,collisions:Ie,droppableRects:$,draggableNodes:C,draggingNode:ye,draggingNodeRect:Ne,droppableContainers:T,over:ge,scrollableAncestors:he,scrollAdjustedTranslate:Ce},K.current={initial:Ne,translated:De}},[X,Y,Ie,De,C,ye,Ne,$,T,ge,he,Ce]),Dr({...fe,delta:M,draggingRect:De,pointerCoordinates:Mt,scrollableAncestors:he,scrollableAncestorRects:qe});const Rn=c.useMemo(()=>({active:X,activeNode:Y,activeNodeRect:k,activatorEvent:U,collisions:Ie,containerNodeRect:Me,dragOverlay:de,draggableNodes:C,droppableContainers:T,droppableRects:$,over:ge,measureDroppableContainers:_,scrollableAncestors:he,scrollableAncestorRects:qe,measuringConfiguration:A,measuringScheduled:te,windowRect:ot}),[X,Y,k,U,Ie,Me,de,C,T,$,ge,_,he,qe,A,te,ot]),En=c.useMemo(()=>({activatorEvent:U,activators:Lt,active:X,activeNodeRect:k,ariaDescribedById:{draggable:y},dispatch:D,draggableNodes:C,over:ge,measureDroppableContainers:_}),[U,Lt,X,k,D,y,C,ge,_]);return W.createElement(tn.Provider,{value:w},W.createElement(st.Provider,{value:En},W.createElement(xn.Provider,{value:Rn},W.createElement(bn.Provider,{value:Sn},d)),W.createElement(qr,{disabled:l?.restoreFocus===!1})),W.createElement(Vn,{...l,hiddenTextDescribedById:y}));function kn(){const B=le?.autoScrollEnabled===!1,q=typeof u=="object"?u.enabled===!1:u===!1,V=N&&!B&&!q;return typeof u=="object"?{...u,enabled:V}:{enabled:V}}}),_r=c.createContext(null),Jt="button",Zr="Draggable";function es(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=He(Zr),{activators:a,activatorEvent:l,active:u,activeNodeRect:d,ariaDescribedById:f,draggableNodes:h,over:g}=c.useContext(st),{role:p=Jt,roleDescription:b="draggable",tabIndex:x=0}=o??{},v=u?.id===t,D=c.useContext(v?bn:_r),[S,w]=Qe(),[j,R]=Qe(),N=Pr(a,t),m=Ue(n);ae(()=>(h.set(t,{id:t,key:s,node:S,activatorNode:j,data:m}),()=>{const M=h.get(t);M&&M.key===s&&h.delete(t)}),[h,t]);const C=c.useMemo(()=>({role:p,tabIndex:x,"aria-disabled":r,"aria-pressed":v&&p===Jt?!0:void 0,"aria-roledescription":b,"aria-describedby":f.draggable}),[r,p,x,v,b,f.draggable]);return{active:u,activatorEvent:l,activeNodeRect:d,attributes:C,isDragging:v,listeners:r?void 0:N,node:S,over:g,setNodeRef:w,setActivatorNodeRef:R,transform:D}}function ts(){return c.useContext(xn)}const ns="Droppable",rs={timeout:25};function ss(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=He(ns),{active:a,dispatch:l,over:u,measureDroppableContainers:d}=c.useContext(st),f=c.useRef({disabled:n}),h=c.useRef(!1),g=c.useRef(null),p=c.useRef(null),{disabled:b,updateMeasurementsFor:x,timeout:v}={...rs,...o},D=Ue(x??r),S=c.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(D.current)?D.current:[D.current]),p.current=null},v)},[v]),w=rt({callback:S,disabled:b||!a}),j=c.useCallback((C,M)=>{w&&(M&&(w.unobserve(M),h.current=!1),C&&w.observe(C))},[w]),[R,N]=Qe(j),m=Ue(t);return c.useEffect(()=>{!w||!R.current||(w.disconnect(),h.current=!1,w.observe(R.current))},[R,w]),c.useEffect(()=>(l({type:L.RegisterDroppable,element:{id:r,key:s,disabled:n,node:R,rect:g,data:m}}),()=>l({type:L.UnregisterDroppable,key:s,id:r})),[r]),c.useEffect(()=>{n!==f.current.disabled&&(l({type:L.SetDroppableDisabled,id:r,key:s,disabled:n}),f.current.disabled=n)},[r,s,n,l]),{active:a,rect:g,isOver:u?.id===r,node:R,over:u,setNodeRef:N}}function jt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function os(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function Ge(e){return e!==null&&e>=0}function is(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function as(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Rt=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=jt(t,r,n),a=t[o],l=s[o];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},vn="Sortable",mn=W.createContext({activeIndex:-1,containerId:vn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Rt,disabled:{draggable:!1,droppable:!1}});function ls(e){let{children:t,id:n,items:r,strategy:o=Rt,disabled:s=!1}=e;const{active:a,dragOverlay:l,droppableRects:u,over:d,measureDroppableContainers:f}=ts(),h=He(vn,n),g=l.rect!==null,p=c.useMemo(()=>r.map(N=>typeof N=="object"&&"id"in N?N.id:N),[r]),b=a!=null,x=a?p.indexOf(a.id):-1,v=d?p.indexOf(d.id):-1,D=c.useRef(p),S=!is(p,D.current),w=v!==-1&&x===-1||S,j=as(s);ae(()=>{S&&b&&f(p)},[S,p,b,f]),c.useEffect(()=>{D.current=p},[p]);const R=c.useMemo(()=>({activeIndex:x,containerId:h,disabled:j,disableTransforms:w,items:p,overIndex:v,useDragOverlay:g,sortedRects:os(p,u),strategy:o}),[x,h,j.draggable,j.droppable,w,p,v,u,g,o]);return W.createElement(mn.Provider,{value:R},t)}const cs=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return jt(n,r,o).indexOf(t)},ds=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:a,previousItems:l,previousContainerId:u,transition:d}=e;return!d||!r||l!==s&&o===a?!1:n?!0:a!==o&&t===u},us={duration:200,easing:"ease"},wn="transform",fs=Be.Transition.toString({property:wn,duration:0,easing:"linear"}),hs={roleDescription:"sortable"};function gs(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,a]=c.useState(null),l=c.useRef(n);return ae(()=>{if(!t&&n!==l.current&&r.current){const u=o.current;if(u){const d=ke(r.current,{ignoreTransform:!0}),f={x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height};(f.x||f.y)&&a(f)}}n!==l.current&&(l.current=n)},[t,n,r,o]),c.useEffect(()=>{s&&a(null)},[s]),s}function ps(e){let{animateLayoutChanges:t=ds,attributes:n,disabled:r,data:o,getNewIndex:s=cs,id:a,strategy:l,resizeObserverConfig:u,transition:d=us}=e;const{items:f,containerId:h,activeIndex:g,disabled:p,disableTransforms:b,sortedRects:x,overIndex:v,useDragOverlay:D,strategy:S}=c.useContext(mn),w=xs(r,p),j=f.indexOf(a),R=c.useMemo(()=>({sortable:{containerId:h,index:j,items:f},...o}),[h,o,j,f]),N=c.useMemo(()=>f.slice(f.indexOf(a)),[f,a]),{rect:m,node:C,isOver:M,setNodeRef:T}=ss({id:a,data:R,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...u}}),{active:I,activatorEvent:K,activeNodeRect:X,attributes:J,setNodeRef:le,listeners:me,isDragging:U,over:re,setActivatorNodeRef:Q,transform:y}=es({id:a,data:R,attributes:{...hs,...n},disabled:w.draggable}),O=Ln(T,le),A=!!I,$=A&&!b&&Ge(g)&&Ge(v),_=!D&&U,te=_&&$?y:null,Ke=$?te??(l??S)({rects:x,activeNodeRect:X,activeIndex:g,overIndex:v,index:j}):null,fe=Ge(g)&&Ge(v)?s({id:a,items:f,activeIndex:g,overIndex:v}):j,ce=I?.id,k=c.useRef({activeId:ce,items:f,newIndex:fe,containerId:h}),Me=f!==k.current.items,se=t({active:I,containerId:h,isDragging:U,isSorting:A,id:a,index:j,items:f,newIndex:k.current.newIndex,previousItems:k.current.items,previousContainerId:k.current.containerId,transition:d,wasDragging:k.current.activeId!=null}),we=gs({disabled:!se,index:j,node:C,rect:m});return c.useEffect(()=>{A&&k.current.newIndex!==fe&&(k.current.newIndex=fe),h!==k.current.containerId&&(k.current.containerId=h),f!==k.current.items&&(k.current.items=f)},[A,fe,h,f]),c.useEffect(()=>{if(ce===k.current.activeId)return;if(ce!=null&&k.current.activeId==null){k.current.activeId=ce;return}const ye=setTimeout(()=>{k.current.activeId=ce},50);return()=>clearTimeout(ye)},[ce]),{active:I,activeIndex:g,attributes:J,data:R,rect:m,index:j,newIndex:fe,items:f,isOver:M,isSorting:A,isDragging:U,listeners:me,node:C,overIndex:v,over:re,setNodeRef:O,setActivatorNodeRef:Q,setDroppableNodeRef:T,setDraggableNodeRef:le,transform:we??Ke,transition:de()};function de(){if(we||Me&&k.current.newIndex===j)return fs;if(!(_&&!yt(K)||!d)&&(A||se))return Be.Transition.toString({...d,property:wn})}}function xs(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(r=e?.droppable)!=null?r:t.droppable}}function et(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const bs=[E.Down,E.Right,E.Up,E.Left],vs=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:s,over:a,scrollableAncestors:l}}=t;if(bs.includes(e.code)){if(e.preventDefault(),!n||!r)return;const u=[];s.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const g=o.get(h.id);if(g)switch(e.code){case E.Down:r.top<g.top&&u.push(h);break;case E.Up:r.top>g.top&&u.push(h);break;case E.Left:r.left>g.left&&u.push(h);break;case E.Right:r.left<g.left&&u.push(h);break}});const d=_n({collisionRect:r,droppableRects:o,droppableContainers:u});let f=sn(d,"id");if(f===a?.id&&d.length>1&&(f=d[1].id),f!=null){const h=s.get(n.id),g=s.get(f),p=g?o.get(g.id):null,b=g?.node.current;if(b&&p&&h&&g){const v=nt(b).some((N,m)=>l[m]!==N),D=yn(h,g),S=ms(h,g),w=v||!D?{x:0,y:0}:{x:S?r.width-p.width:0,y:S?r.height-p.height:0},j={x:p.left,y:p.top};return w.x&&w.y?j:$e(j,w)}}}};function yn(e,t){return!et(e)||!et(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function ms(e,t){return!et(e)||!et(t)||!yn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const ws=({id:e,onRemove:t})=>{const{attributes:n,listeners:r,setNodeRef:o,transform:s,transition:a,isDragging:l}=ps({id:e}),u={transform:Be.Transform.toString(s),transition:a,zIndex:l?50:"auto",opacity:l?.5:1};return i.jsxs("div",{ref:o,style:u,...n,...r,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white/5 border border-white/10 group hover:border-white/30 transition-all cursor-move select-none touch-none",children:[i.jsx("span",{className:"text-gray-300",children:e}),i.jsx("button",{onClick:d=>{d.stopPropagation(),t()},onPointerDown:d=>d.stopPropagation(),className:"text-gray-600 hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100",children:i.jsx(P.X,{className:"w-4 h-4"})})]})},ys=({categoryLabel:e,exercises:t,onAddExercise:n,onRemoveExercise:r,onReorder:o})=>{const[s,a]=c.useState(""),l=Gn(Ft(St,{activationConstraint:{distance:8}}),Ft(Ct,{coordinateGetter:vs})),u=f=>{const{active:h,over:g}=f;if(g&&h.id!==g.id){const p=t.indexOf(h.id),b=t.indexOf(g.id);o(jt(t,p,b))}},d=()=>{s.trim()&&(n(s.trim()),a(""))};return i.jsxs("div",{className:"mb-8 p-6 rounded-3xl bg-white/[0.03] border border-white/[0.05] animate-fade-in",children:[i.jsxs("h3",{className:"text-lg font-bold mb-4 text-purple-400",children:["管理",e,"动作"]}),i.jsxs("div",{className:"flex gap-3 mb-6",children:[i.jsx("input",{type:"text",value:s,onChange:f=>a(f.target.value),className:"flex-1 px-4 py-3 rounded-xl bg-black/20 border border-white/10 focus:border-purple-500 outline-none transition-all text-base placeholder-white/20",placeholder:"输入新动作名称..."}),i.jsx("button",{onClick:d,disabled:!s.trim(),className:"px-6 py-3 rounded-xl bg-purple-600 text-white font-medium hover:bg-purple-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"添加"})]}),i.jsx(Qr,{sensors:l,collisionDetection:Qn,onDragEnd:u,children:i.jsx(ls,{items:t,strategy:Rt,children:i.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.map(f=>i.jsx(ws,{id:f,onRemove:()=>r(f)},f)),t.length===0&&i.jsx("span",{className:"text-gray-500 text-sm",children:"暂无动作，请添加"})]})})})]})};function Qt({value:e,onChange:t,options:n,placeholder:r,label:o}){const[s,a]=c.useState(!1);return i.jsxs("div",{className:"relative",children:[o&&i.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:o}),i.jsxs("button",{type:"button",onClick:()=>a(!s),className:"w-full px-4 py-3 rounded-xl bg-black/20 border border-white/10 focus:border-purple-500 outline-none transition-all text-base text-left flex items-center justify-between text-white group",children:[i.jsx("span",{className:e?"text-white":"text-gray-500",children:e?n.find(l=>l.value===e)?.label||e:r||"Select..."}),i.jsx("span",{className:`text-gray-500 text-xs transition-transform duration-200 group-hover:text-white ${s?"rotate-180":""}`,children:"▼"})]}),s&&i.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>a(!1)}),s&&i.jsxs("div",{className:"absolute z-20 w-full mt-2 bg-[#1a1a1a] border border-white/10 rounded-xl shadow-xl shadow-black/50 max-h-60 overflow-y-auto animate-fade-in backdrop-blur-xl",children:[n.map(l=>i.jsxs("button",{type:"button",onClick:()=>{t(l.value),a(!1)},className:`w-full px-4 py-3 text-left hover:bg-white/5 transition-colors flex items-center justify-between ${e===l.value?"text-purple-400 bg-white/[0.02]":"text-gray-300"}`,children:[i.jsx("span",{children:l.label}),e===l.value&&i.jsx("span",{className:"text-purple-500",children:"✓"})]},l.value)),n.length===0&&i.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"暂无选项"})]})]})}const Ns=({exercises:e,initialExercise:t="",groupedRecords:n,onSave:r,onCancel:o,onOpenExerciseManager:s})=>{const[a,l]=c.useState({exercise:t,reps:0,weight:0,weightUnit:"kg"});c.useEffect(()=>{t&&l(d=>({...d,exercise:t}))},[t]);const u=()=>{a.exercise&&a.reps&&r(a)};return i.jsxs("div",{className:"mb-10 p-6 rounded-3xl bg-white/[0.03] border border-white/[0.05]",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx(Qt,{label:"Exercise",placeholder:"选择动作...",value:a.exercise,onChange:d=>l({...a,exercise:d}),options:e.map(d=>({value:d,label:d}))}),e.length===0&&i.jsx("p",{className:"text-xs text-red-400 mt-2 cursor-pointer",onClick:s,children:"当前无可用动作，请先点击此处或右上角设置图标添加动作。"})]}),a.exercise&&n[a.exercise]&&n[a.exercise].length>0&&i.jsxs("div",{className:"md:col-span-2 mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"今日已记录组数"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:n[a.exercise].map((d,f)=>i.jsxs("div",{className:"px-3 py-1.5 rounded-lg bg-white/5 border border-white/10 text-sm text-gray-300 flex items-center gap-2",children:[i.jsxs("span",{className:"text-purple-400 font-mono",children:["#",f+1]}),i.jsxs("span",{children:[d.reps," x ",d.weight,d.weightUnit||"kg"]})]},d.id))})]}),i.jsxs("div",{children:[i.jsx(Qt,{label:"Reps",placeholder:"0",value:a.reps||"",onChange:d=>l({...a,reps:d}),options:Array.from({length:30},(d,f)=>f+1).map(d=>({value:d,label:d.toString()}))}),i.jsx("div",{className:"flex gap-2 mt-2",children:[6,8,10,12].map(d=>i.jsx("button",{onClick:()=>l({...a,reps:d}),className:"px-3 py-1 rounded-lg bg-white/5 hover:bg-white/10 text-xs text-gray-400 hover:text-white transition-colors",children:d},d))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"Weight"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"number",value:a.weight||"",onChange:d=>l({...a,weight:parseFloat(d.target.value)||0}),className:"flex-1 px-4 py-3 rounded-xl bg-black/20 border border-white/10 focus:border-purple-500 outline-none transition-all text-base placeholder-white/20",placeholder:"0"}),i.jsxs("div",{className:"flex bg-black/20 rounded-xl border border-white/10 p-1",children:[i.jsx("button",{onClick:()=>l({...a,weightUnit:"kg"}),className:`px-3 rounded-lg text-sm font-medium transition-all ${a.weightUnit==="kg"?"bg-purple-600 text-white":"text-gray-500 hover:text-white"}`,children:"kg"}),i.jsx("button",{onClick:()=>l({...a,weightUnit:"lbs"}),className:`px-3 rounded-lg text-sm font-medium transition-all ${a.weightUnit==="lbs"?"bg-purple-600 text-white":"text-gray-500 hover:text-white"}`,children:"lbs"})]})]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:o,className:"px-6 py-4 rounded-xl bg-white/5 text-gray-400 font-medium hover:bg-white/10 hover:text-white transition-all",children:"取消"}),i.jsx("button",{onClick:u,disabled:!a.exercise||!a.reps,className:"flex-1 py-4 rounded-xl bg-purple-600 text-white font-medium hover:bg-purple-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-purple-900/20",children:"添加一组"})]})]})},Cs=({groupedRecords:e,previousMaxWeights:t,onEditExercise:n,onLongPressRecord:r,showAddForm:o})=>{const s=W.useRef(null),a=b=>{s.current=setTimeout(()=>{r(b)},300)},l=()=>{s.current&&(clearTimeout(s.current),s.current=null)},u=()=>{s.current&&(clearTimeout(s.current),s.current=null)},d=b=>{s.current=setTimeout(()=>{r(b)},300)},f=()=>{s.current&&(clearTimeout(s.current),s.current=null)},[h,g]=W.useState(new Set),p=b=>{const x=new Set(h);x.has(b)?x.delete(b):x.add(b),g(x)};return Object.keys(e).length===0?o?null:i.jsx("div",{className:"py-20 text-center",children:i.jsx("p",{className:"text-gray-600",children:"今日无记录"})}):i.jsx("div",{className:"space-y-6",children:Object.entries(e).map(([b,x])=>{const v=h.has(b),D=x.length>4,S=[...x].reverse(),w=D&&!v?S.slice(0,4):S,j=Math.max(...x.map(m=>m.weight)),R=t[b],N=R?j-R:0;return i.jsxs("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-3xl p-6 transition-all",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("h4",{className:"text-xl font-bold text-white",children:b}),i.jsxs(Mn,{to:`/exercise-history/${On(b)}`,className:"text-xs font-medium text-purple-400 bg-purple-500/10 px-2 py-1 rounded-lg w-fit hover:bg-purple-500/20 transition-colors flex items-center gap-1.5",children:[i.jsxs("span",{children:["今日最重: ",j,"kg"]}),N!==0&&i.jsxs("span",{className:`flex items-center ${N>0?"text-green-400":"text-red-400"}`,children:[N>0?"+":"",N,"kg",N>0?i.jsx(P.TrendingUp,{className:"w-3 h-3 ml-0.5"}):i.jsx(P.TrendingDown,{className:"w-3 h-3 ml-0.5"})]}),N===0&&R&&i.jsx("span",{className:"text-gray-400",children:"-"})]})]}),i.jsxs("span",{className:"text-sm text-gray-500",children:[x.length," sets"]})]}),i.jsx("div",{className:"space-y-2",children:w.map((m,C)=>i.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-colors group select-none active:scale-[0.98] duration-200",onTouchStart:()=>a(m),onTouchEnd:l,onTouchMove:u,onMouseDown:()=>d(m),onMouseUp:f,onMouseLeave:f,children:[i.jsxs("div",{className:"flex items-center gap-4 pointer-events-none",children:[i.jsxs("div",{className:"flex flex-col items-center gap-1",children:[i.jsxs("span",{className:"text-gray-500 font-mono text-sm w-8",children:["#",x.length-C]}),m.time&&i.jsx("span",{className:"text-[10px] text-gray-600 font-mono",children:m.time})]}),i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"text-xl font-bold text-white",children:m.reps}),i.jsx("span",{className:"text-xs text-gray-500 uppercase",children:"reps"})]}),i.jsx("span",{className:"text-gray-600",children:"×"}),i.jsxs("div",{className:"flex items-baseline gap-1",children:[i.jsx("span",{className:"text-lg font-medium text-purple-400",children:m.weight}),i.jsx("span",{className:"text-xs text-purple-400/70",children:m.weightUnit||"kg"})]})]}),i.jsx("div",{className:"flex items-center gap-4 pointer-events-none",children:i.jsxs("div",{className:"text-right hidden md:block",children:[i.jsx("div",{className:"text-xs text-gray-600 uppercase tracking-wider",children:"Volume"}),i.jsxs("div",{className:"text-sm font-light text-gray-400",children:[(m.reps*m.weight).toLocaleString()," ",m.weightUnit||"kg"]})]})})]},m.id))}),D&&i.jsx("button",{onClick:()=>p(b),className:"w-full mt-3 py-3.5 rounded-2xl bg-white/[0.03] hover:bg-white/[0.06] active:bg-white/[0.08] border border-white/[0.05] text-sm font-medium text-gray-400 hover:text-white transition-all flex items-center justify-center gap-2 group",children:v?i.jsxs(i.Fragment,{children:[i.jsx("span",{children:"收起记录"}),i.jsx(P.ChevronUp,{className:"w-4 h-4 opacity-70 group-hover:opacity-100 transition-opacity"})]}):i.jsxs(i.Fragment,{children:[i.jsxs("span",{children:["展开剩余 ",x.length-4," 组"]}),i.jsx(P.ChevronDown,{className:"w-4 h-4 opacity-70 group-hover:opacity-100 transition-opacity"})]})}),i.jsxs("button",{onClick:()=>n(b),className:"w-full mt-4 py-3 rounded-xl border border-dashed border-white/10 hover:border-purple-500/50 hover:bg-purple-500/10 text-gray-500 hover:text-purple-300 transition-all flex items-center justify-center gap-2 group",children:[i.jsx(P.Plus,{className:"w-4 h-4 group-hover:scale-110 transition-transform"}),i.jsx("span",{className:"text-sm font-medium",children:"Add Set"})]})]},b)})})},Ds=({activeCategoryConfig:e,records:t,selectedCategory:n,selectedDate:r,onDateChange:o,onBack:s,showExerciseManager:a,onToggleExerciseManager:l})=>{const u=c.useMemo(()=>{if(!n)return null;const f=new Date().toISOString().split("T")[0],h=t.filter(x=>x.category===n&&x.date<f).map(x=>x.date).sort((x,v)=>new Date(v).getTime()-new Date(x).getTime());if(h.length===0)return"首次训练";const g=h[0],p=Math.abs(new Date(f).getTime()-new Date(g).getTime());return`上次训练：${Math.ceil(p/(1e3*60*60*24))}天前 (${lt(g)})`},[t,n]),d=f=>{const h=new Date(r);h.setDate(h.getDate()+f),o(h.toISOString().split("T")[0])};return i.jsxs("div",{className:"flex flex-col gap-6 mb-10",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("button",{onClick:s,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors group",children:[i.jsx("div",{className:"p-2 rounded-full border border-white/10 group-hover:border-white/30 transition-colors",children:i.jsx(P.ArrowLeft,{className:"w-5 h-5"})}),i.jsx("span",{className:"text-sm font-medium uppercase tracking-wider",children:"Back"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"text-right hidden md:block",children:[i.jsx("div",{className:"text-3xl font-bold",children:e.label}),i.jsx("div",{className:"text-base text-purple-300 font-medium mt-1",children:u})]}),i.jsxs("div",{className:"md:hidden",children:[i.jsx("div",{className:"text-2xl font-bold text-right",children:e.label}),i.jsx("div",{className:"text-sm text-purple-300 font-medium text-right mt-1",children:u})]}),i.jsx(e.icon,{className:`w-10 h-10 ${e.color}`})]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex-1 flex items-center justify-between bg-white/[0.03] rounded-2xl p-2 border border-white/[0.05]",children:[i.jsx("button",{onClick:()=>d(-1),className:"p-3 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors",children:i.jsx(P.ChevronLeft,{className:"w-5 h-5"})}),i.jsxs("div",{className:"relative group cursor-pointer",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-medium text-white",children:lt(r)}),lt(r)!==r&&i.jsx("div",{className:"text-xs text-gray-500 font-mono",children:r})]}),i.jsx("input",{type:"date",value:r,onChange:f=>f.target.value&&o(f.target.value),className:"absolute inset-0 opacity-0 cursor-pointer"})]}),i.jsx("button",{onClick:()=>d(1),className:"p-3 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors",children:i.jsx(P.ChevronRight,{className:"w-5 h-5"})})]}),i.jsx("button",{onClick:l,className:`p-4 rounded-2xl border transition-all duration-300 ${a?"bg-purple-500/20 border-purple-500/50 text-purple-300":"bg-white/[0.03] border-white/[0.05] hover:bg-white/[0.06] text-gray-400 hover:text-white"}`,title:"管理动作",children:i.jsx(P.Settings,{className:"w-6 h-6"})})]})]})},_t=({exercise:e,initialValues:t,onSave:n,onClose:r,submitLabel:o=t?"Update Set":"Add Set"})=>{const[s,a]=c.useState(0),[l,u]=c.useState(0),[d,f]=c.useState("kg");c.useEffect(()=>{t&&(a(t.reps),u(t.weight),f(t.weightUnit))},[t]);const h=()=>{s>0&&n({reps:s,weight:l,weightUnit:d})};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/60 backdrop-blur-sm animate-fade-in",children:i.jsxs("div",{className:"w-full max-w-md bg-[#1c1c1e] rounded-t-3xl p-6 shadow-2xl animate-slide-up border-t border-white/10",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:e}),i.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:i.jsx(P.X,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-white/5 rounded-2xl p-4 border border-white/5",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"Reps"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:()=>a(Math.max(0,s-1)),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors shrink-0",children:i.jsx(P.Minus,{className:"w-4 h-4"})}),i.jsx("input",{type:"number",value:s||"",onChange:g=>a(parseInt(g.target.value)||0),className:"flex-1 min-w-0 bg-transparent text-center text-2xl font-bold text-white outline-none",placeholder:"0"}),i.jsx("button",{onClick:()=>a(s+1),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors shrink-0",children:i.jsx(P.Plus,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"flex justify-center gap-2 mt-3",children:[8,10,12].map(g=>i.jsx("button",{onClick:()=>a(g),className:`w-8 h-8 rounded-full text-xs font-medium transition-all ${s===g?"bg-purple-600 text-white":"bg-white/5 text-gray-400 hover:bg-white/10"}`,children:g},g))})]}),i.jsxs("div",{className:"bg-white/5 rounded-2xl p-4 border border-white/5",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"Weight"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:()=>u(Math.max(0,l-2.5)),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors shrink-0",children:i.jsx(P.Minus,{className:"w-4 h-4"})}),i.jsx("input",{type:"number",value:l||"",onChange:g=>u(parseFloat(g.target.value)||0),className:"flex-1 min-w-0 bg-transparent text-center text-2xl font-bold text-white outline-none",placeholder:"0"}),i.jsx("button",{onClick:()=>u(l+2.5),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors shrink-0",children:i.jsx(P.Plus,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"flex justify-center mt-3",children:i.jsxs("div",{className:"relative flex bg-white/5 rounded-lg p-1 cursor-pointer",children:[i.jsx("div",{className:`absolute top-1 bottom-1 w-[calc(50%-4px)] bg-purple-600 rounded-md transition-all duration-300 ease-out ${d==="kg"?"left-1":"left-[calc(50%+0px)]"}`}),i.jsx("button",{onClick:()=>f("kg"),className:`relative z-10 px-4 py-1 text-xs font-medium transition-colors duration-300 ${d==="kg"?"text-white":"text-gray-400 hover:text-white"}`,children:"kg"}),i.jsx("button",{onClick:()=>f("lbs"),className:`relative z-10 px-4 py-1 text-xs font-medium transition-colors duration-300 ${d==="lbs"?"text-white":"text-gray-400 hover:text-white"}`,children:"lbs"})]})})]})]}),i.jsx("button",{onClick:h,disabled:s===0,className:"w-full py-4 rounded-xl bg-purple-600 text-white font-bold text-lg hover:bg-purple-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-purple-900/20",children:o}),i.jsx("div",{className:"h-6"})," "]})})},Ss=({onEdit:e,onDelete:t,onClose:n})=>i.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/60 backdrop-blur-sm animate-fade-in",onClick:n,children:i.jsxs("div",{className:"w-full max-w-md bg-[#1c1c1e] rounded-t-3xl p-4 shadow-2xl animate-slide-up border-t border-white/10",onClick:r=>r.stopPropagation(),children:[i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("button",{onClick:()=>{e(),n()},className:"w-full py-4 rounded-2xl bg-white/10 hover:bg-white/15 text-white font-medium text-lg transition-colors flex items-center justify-center gap-2",children:[i.jsx(P.Edit,{className:"w-5 h-5"}),"编辑"]}),i.jsxs("button",{onClick:()=>{t(),n()},className:"w-full py-4 rounded-2xl bg-red-500/10 hover:bg-red-500/20 text-red-400 font-medium text-lg transition-colors flex items-center justify-center gap-2",children:[i.jsx(P.Trash,{className:"w-5 h-5"}),"删除"]})]}),i.jsx("button",{onClick:n,className:"w-full mt-4 py-4 rounded-2xl bg-black/20 hover:bg-black/30 text-gray-400 font-medium text-lg transition-colors",children:"取消"}),i.jsx("div",{className:"h-6"})]})});function ks(){const{categoryId:e}=In(),t=An(),n=zt.some(y=>y.id===e)?e:null,[r,o]=c.useState(new Date().toISOString().split("T")[0]),{records:s,exercises:a,addRecord:l,deleteRecord:u,updateRecord:d,addExercise:f,removeExercise:h,reorderExercises:g}=Tn(),[p,b]=c.useState(!1);c.useEffect(()=>{n&&(o(new Date().toISOString().split("T")[0]),v(!1),b(!1))},[n]);const[x,v]=c.useState(!1),[D,S]=c.useState(""),[w,j]=c.useState(null),[R,N]=c.useState(void 0),[m,C]=c.useState(null),[M,T]=c.useState(null),I=y=>{!y||!n||f(n,y)},K=y=>{n&&h(n,y)},X=y=>{if(!n)return;const O={id:Date.now().toString(),category:n,...y,sets:1,date:r,time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})};l(O)},J=y=>{u(y)},le=zt.find(y=>y.id===n),me=s.filter(y=>y.category===n&&y.date===r),U=n?a[n]||[]:[],re=me.reduce((y,O)=>(y[O.exercise]||(y[O.exercise]=[]),y[O.exercise].push(O),y),{});Object.keys(re).forEach(y=>{re[y].sort((O,A)=>parseInt(O.id)-parseInt(A.id))});const Q={};return Object.keys(re).forEach(y=>{const O=s.filter(A=>A.exercise===y&&A.date<r);if(O.length>0){O.sort((te,Y)=>Y.date.localeCompare(te.date));const A=O[0].date,$=O.filter(te=>te.date===A),_=Math.max(...$.map(te=>te.weight));Q[y]=_}}),!n||!le?i.jsx("div",{className:"text-white text-center mt-20",children:"Category not found"}):i.jsxs("div",{className:"min-h-screen bg-[#0a0a0a] text-white font-sans selection:bg-white/20",children:[i.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[i.jsx("div",{className:"absolute -top-[20%] -left-[10%] w-[70vw] h-[70vw] bg-purple-900/10 rounded-full blur-[120px] animate-pulse-slow"}),i.jsx("div",{className:"absolute top-[40%] -right-[10%] w-[60vw] h-[60vw] bg-blue-900/10 rounded-full blur-[120px]"})]}),i.jsx("div",{className:"relative max-w-3xl mx-auto px-6 py-12 md:py-20",children:i.jsxs("div",{className:"animate-fade-in",children:[i.jsx(Ds,{activeCategoryConfig:le,records:s,selectedCategory:n,selectedDate:r,onDateChange:o,onBack:()=>{t("/")},showExerciseManager:p,onToggleExerciseManager:()=>b(!p)}),p&&i.jsx(ys,{categoryLabel:le.label,exercises:U,onAddExercise:I,onRemoveExercise:K,onReorder:y=>{n&&g(n,y)}}),!x&&!p&&i.jsxs("button",{onClick:()=>{S(""),v(!0)},className:"w-full py-4 mb-8 rounded-2xl border border-dashed border-white/20 text-gray-500 hover:text-white hover:border-white/40 hover:bg-white/[0.02] transition-all duration-300 flex items-center justify-center gap-2",children:[i.jsx(P.Plus,{className:"w-5 h-5"}),i.jsx("span",{children:"添加新记录"})]}),x&&i.jsx(Ns,{exercises:U,initialExercise:D,groupedRecords:re,onSave:y=>{X(y),v(!1)},onCancel:()=>v(!1),onOpenExerciseManager:()=>{v(!1),b(!0)}}),i.jsx(Cs,{groupedRecords:re,previousMaxWeights:Q,onEditExercise:y=>{const A=s.filter($=>$.exercise===y).sort(($,_)=>new Date(_.date).getTime()-new Date($.date).getTime()||parseInt(_.id)-parseInt($.id))[0];N(A?{reps:A.reps,weight:A.weight,weightUnit:A.weightUnit}:void 0),j(y)},onLongPressRecord:y=>{C(y)},showAddForm:x}),w&&i.jsx(_t,{exercise:w,initialValues:R,submitLabel:"Add Set",onSave:y=>{X({exercise:w,...y}),j(null)},onClose:()=>j(null)}),M&&i.jsx(_t,{exercise:M.exercise,initialValues:{reps:M.reps,weight:M.weight,weightUnit:M.weightUnit},submitLabel:"Update Set",onSave:y=>{d(M.id,y),T(null)},onClose:()=>T(null)}),m&&i.jsx(Ss,{onEdit:()=>{T(m),C(null)},onDelete:()=>{J(m.id),C(null)},onClose:()=>C(null)})]})})]})}export{ks as default};
